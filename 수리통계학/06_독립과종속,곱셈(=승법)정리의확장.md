#06. 독립과 종속, 곱셈(=승법) 정리의 확장

두 사상 A와 B가 서로 독립이면 
P(A)=P(A|B), P(B)=P(B|A)
P(A&B)=P(A)P(B|A) = (독립이면)P(A)P(B)
=> P(A&B) = P(A) x P(B)

세개의 사상 A,B,C가 서로 독립이면
P(A&B) = P(A) x P(B), P(A&C) = P(A) x P(C), P(B&C) = P(B) x P(C)
P(A&B&C) = P(A&B) x P(C) = P(A) x P(B) x P(C)


예제32)
목표물을 명중할 확률이 각각 1/2, 2/3인 두 사람이 있다. 
두 사람이 목표물에 사격할 때 명중할 확률은?

첫번째 명중 => 사상 A
두번째 명중 => 사상 B
: 서로 독립

P(A U B)= P(A) + P(B) - P(A&B) 
= P(A) + P(B) - P(A)P(B)
= 1/2 + 2/3 - 1/2 x 2/3
= 7/6 - 2/6 = 5/6


예제33) 
A와 B가 서로 독립이면 A와 Bc, Ac와 B, Ac와 Bc 들도 각각 서로 독립이다.

> P(A&B) = P(A)P(B) 이므로
> 1) P(A&Bc) = P(A) - P(A&B) = P(A) - P(A)P(B) = P(A){1 - P(B)} = P(A)P(Bc)
> 2) P(Ac&B) = P(B) - P(A&B) = P(B) - P(A)P(B) = P(B){1 - P(A)} = P(B)P(Ac)
> 3) P(Ac&Bc) = P((A U B)c) = 1 - P(AuB) 
> = 1 - {P(A) + P(B) - P(A)P(B)}
> = 1 - P(A) - P(B){1 - P(A)}
> = (1 - P(A)) (1 - P(B))
 
예제34)
A와 B가 독립이고 P(A)=0.6, P(B)=0.3일 떄 확률 P(AuBc)?

> P(A) + P(Bc) - P(A&Bc)
> A와 Bc도 서로 독립 => P(A&Bc) = P(A)P(Bc)
> = P(A) + P(Bc) - P(A)P(Bc)
> = 0.6 + 0.7 - 0.6 x 0.7
> = 1.3 - 0.42
> = 0.88

예제35)
A,B,C가 서로 독립이면 
A&B&Cc, (1)
A와 BuC, (2)
A와 B&C (3)도 서로 독립임을 증명하여라

> P(A&B) = P(A)P(B) P(A&C) = P(A)P(C), P(B&C) = P(B)P(C)
> P(A&B&C) = P(A)P(B)P(C)
> 
> (1) P((A&B)&Cc) = P(A&B)P(Cc)임을 보이면 된다
>  P(A&Bc) = P(A) - P(A&B)
>  P((A&B)&Cc) 
>   = P(A&B) - P(A&B&C)
>   = P(A)P(B) - P(A)P(B)P(C)
>   = P(A)P(B){1 - P(C)}
>   = P(A&B)P(Cc)
>  
> (2) P(A&(BuC)) = P(A)P(BuC)임을 보이면 된다
>  P(A&(BuC)) = P((A&B) u (A&C))
>  = P(A&B) + P(A&C) - P(A&B&C)( = P(AuB) = P(A) + P(B) - P(A&B) 이기 때문에)
>  = P(A)P(B) + P(A)P(C) - P(A)P(B)P(C)
>  = P(A){P(B) + P(C) - P(B&C)}
>  = P(A)P(BuC)
>  
>  (3) P(A&(B&C)) = P(A)P(B&C)임을 보이면 된다.
>  P(A&(B&C)) = P(A&B&C) = P(A)P(B)P(C)
>  = P(A)P(B&C)

예제36)
1에서 30까지의 자연수 중에서 하나를 뽑을 때 
사상 A={짝수}
사상 B={3의 배수}
사상 C={5의 배수}
일 때 A,B,C는 서로 독립인가?

> P(A) = 15/30 = 1/2
> P(B) = 10/30 = 1/3
> P(C) = 6/30 = 1/5
> 
> P(A&B) = P(6의배수) = 5/30 = 1/6 = P(A)P(B)
> P(A&C) = P(10의배수) = 3/30 = 1/10 = P(A)P(B)
> P(B&C) = P(15의배수) = 2/30 = 1/15 = P(B)P(C)
> P(A&B&C) = P(30의배수) = 1/30 = P(A)P(B)P(C)
> 
> A,B,C는 서로 독립이다


##Thm(9): 곱셈정리(승법정리)의 확장
어떤 실험에서 사상 A1, A2, ..., Ak가 발생 가능하다면
P(A1&A2& ... & Ak) = P(A1)P(A2|A1)P(A3|A1&A2) ... P(Ak|A1&A2&...&Ak-1)이 성립한다.

P(A2|A1) = P(A1&A2) / P(A1) => P(A1&A2) = P(A1)P(A2|A1)
P(A3|A1&A2) = P(A1&A2&A3) / P(A1&A2) => P(A1&A2&A3) = P(A1&A2)P(A3|A1&A2)
= P(A1)P(A2|A1)P(A3|A1&A2) 형태로 펼쳐짐을 알 수 있다.

P(A1&A2&A3&A4) 
= P(A1)P(A2|A1)P(A3|A1&A2)P(A4|A1&A2&A3) : 앞의 확률을 조건부로 가져오는 형식

예제37)
52장 카드에서 한 장씩 차례로 4장 뽑을 때,
2, 5, 7, 7이 나올 확률은?(비복원)

> 2 => A1
> 5 => A2
> 7 => A3
> 7 => A4 라 해보자
> 
> P(A1&A2&A3&A4) = P(A1)P(A2|A1)P(A3|A1&A2)P(A4|A1&A2&A3)
> 
> = 4/52 x 4/51 x 4/50 x 3/49
> = 0.00003 

예제38)
검은공 9개, 흰공 1개 주머니에서 비복원추출로 공을 계속 1개씩 꺼낼때 
4번째 공이 흰공일 확률?

> 흰공이 하나이기 때문에 XXXO 이 되어야 한다
> P(A1&A2&A3&A4)
> = P(A1)P(A2|A1)P(A3|A1&A2)P(A4|A1&A2&A3)
> 
> = 9/10 x 8/9 x 7/8 x 1/7 = 1/10