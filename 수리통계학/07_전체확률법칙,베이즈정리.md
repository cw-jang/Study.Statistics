#07. 전체확률법칙, 베이즈정리

##Thm(10): 전체확률법칙
사상 B1, B2, ... , Bk를 표본공간 S의 분할이라 하고
P(B)!=0, i=1,2,...,k라면 S의 임의의 사상 A에 대하여
P(A) = Sig(i,k)P(B&A) = Sig(i,k)P(Bi)P(A|Bi)가 성립한다.

분할? B1 + B2 + .. + Bk 를 합집합하면 표본공간 S여야 하고 
B1, B2, ... Bk 는 공통부분이 없는 서로 배반이어야 한다.

P(A) = P[B1*A u B2&A u B3&A u B4&A]
= P(B1&A) + P(B2&A) + P3(B3&A) + P4(B4&A)
= Sig(1,4)P(Bi&A) 
= Sig(1,4)P(Bi)P(A|Bi)


예제39)
세개의 생산라인에서 각각 전체생산품의 50%,30%,20%를 만들고
각각 2%, 5%, 10% 불량품이 생긴다.
임의로 하나의 생산품을 선택했을때 그 제품이 불량품일 사상을 
D라 할 때 P(D)를 구하여라

> 50% -> A
> 30% -> B
> 20% -> c
> 
> P(D) = P(A&D) + P(B&D) + P(C&D)
> = P(A)P(D|A) + P(B)P(D|B) + P(C)P(D|C)
> = 0.5x0.02 + 0.3x0.05 + 0.2x0.1
> = 0.045

예제40)
빨간공 2개, 흰공 5개가 들어있는 상자와
빨간공 3개, 흰공 4개가 들어있는 상자
첫번째 상자에서 하나의 공을 꺼내어 두번째 상자에 넣고
두번째 상자에서 하나의 공을 꺼낼때 빨간공 확률은?

> 사상B1 = 첫번째 상자에서 빨간공
> 사상B2 = 첫번쨰 상자에서 흰공
> 사상A = 두번째 상자에서 빨간공 
> P(A) = P(B1&A) + P(B2&A)
> = P(B1)P(A|B1) + P(B2)P(A|B2)
> = 1/7 x 4/8 + 5/7 x 3/8
> = 23/56


##Thm(11): 베이즈 정리(Bay's Theorem) (중요!)
B1, B1, ..., Bn이 표본공간 S의 분할이고 A가 S의 임의의 사상이라면

P(Bi|A) = P(Bi)P(A|Bi) / Sig(i,n)P(Bi)P(A|Bi)
(단, P(Bi) > 0, P(A) > 0)

=> P(Bi|A) = P(Bi&A) / P(A) =  P(Bi)P(A|Bi) / Sig(i,n)P(Bi)P(A|Bi)

조건부확률 => "베이즈정리"를 이용해서 푼다.


예제41) 임용기출
어떤공장은 세개의 생산라인 B1,B2,B3에서 각각 30%,45%,25%를 만들고
각각 2%,3%,2%의 불량품이 생긴다. 이때 임의로 선택한 하나의 제품이
불량품이었을때 그 제품이 B3에서 만든 제품일 확률은?

> 사상B1 = 생산라인 B1의 제품
> 사상B2 = 생산라인 B2
> 사상B3 = 생산라인 B3
> 사상A = 불량품
> 
> P(B3|A) =  P(B3)P(A|B3) / Sig(1,3)P(Bi)P(A|Bi)
> = P(B3)P(A|B3) / (P(B1)P(A|B1) + P(B2)P(A|B2) + P(B3)P(A|B3))
> = 0.25*0.02 / (0.3*0.02 + 0.45*0.03 + 0.25*0.02)
> = 50 / (60+135+50)
> = 50/245
> = 10/49

예제42)
상자속에 3장의 카드가 있는데 
하나는 양면이 빨간색, 
두번째는 양면이 모두 파란색
세번째는 한면이 빨간색, 다른면은 파란색이다.
상자에서 한장의 빨간색 카드를 꺼낼때 그 뒷면도 빨간색일 확률은?

> 사상B1 => 양면모두 빨간색
> 사상B2 => 양면모두 파란색
> 사상B3 => 한면은 빨간색, 다른면은 파란색
> 사상A => 보이는면이 빨간색
> 
> P(B1|A) = P(B1&A) / P(A)
> = P(B1)P(A|B1) / [P(B1)P(A|B1) + P(B2)P(A|B2) + P(B3)P(A|B3)]
> = (1/3 x 1) / (1/3 x 1 + 1/3 x 0 + 1/3 x 1/2)
> = 2/3


 예제43)
암검사의 적중률은 95%이다. 즉, 실제 암환자를 검사결과 양성으로 판단할 확률은
0.95이다. 또 암에 걸리지 않은 사람을 검사결과 양성으로 판단할 확률은 0.01이다.
통계적으로 1000명당 5명꼴로 암에 걸린다고 할 때 검사결과 양성으로 
나타난 사람이 실제 암에 걸렸을 확률은?

> 사상B1 => 암에 실제 걸린 사람
> 사상B2 => 암에 걸리지 않은 사람
> 사상A => 검사결과 양성
> 
> P(B1|A) = P(B1&A) / P(A)
> = P(B1)P(A|B1) / {P(B1)P(A|B1) + P(B2)P(A|B2)}
> = 0.005 x 0.95 / (0.005 x 0.95 + 0.995 x 0.01)
> = 약 0.323

